var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _reactNativeColorPicker=require("react-native-color-picker");var _firebase=_interopRequireDefault(require("../database/firebase"));var _reactNativeActionsheet=_interopRequireDefault(require("react-native-actionsheet"));var _jsxFileName="/Users/tuyento/ReactNative/KhoaLuan/todoapp/src/screens/updateColor.js";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){(0,_defineProperty2.default)(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return(0,_possibleConstructorReturn2.default)(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}var App=function(_Component){(0,_inherits2.default)(App,_Component);var _super=_createSuper(App);function App(){var _this;(0,_classCallCheck2.default)(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.updateColor=function(item){var updateDBRef=_firebase.default.firestore().collection('colors').doc(_this.state.id);updateDBRef.set(_objectSpread(_objectSpread({},item),{},{color:_this.state.selectedColor})).then(function(docRef){_this.props.navigation.goBack();}).catch(function(error){console.error('Error: ',error);});};_this.getTaskByColorId=function(id){return _firebase.default.firestore().collection('tasks').where('colorid','==',id+'').get().then(function(querySnapshot){return querySnapshot.docs.map(function(i){return _objectSpread({key:i.id},i.data());});}).catch(function(error){console.log(error);return[];});};_this.deleteColor=function(key){var dbRef=_firebase.default.firestore().collection('colors').doc(key);dbRef.delete().then(function(res){_this.props.navigation.goBack();});};_this.onSelect=function(color){return _this.setState({selectedColor:color});};_this.state={color:(0,_reactNativeColorPicker.toHsv)('green'),selectedColor:_this.props.route.params.data.color,taskText:'',label:'',selected:_this.props.route.params.data,id:_this.props.route.params.id};_this.onColorChange=_this.onColorChange.bind((0,_assertThisInitialized2.default)(_this));return _this;}(0,_createClass2.default)(App,[{key:"onColorChange",value:function onColorChange(color){this.setState({color:color},function(){console.log(color);});}},{key:"render",value:function render(){var _this2=this;var selected=this.state.selected;return _react.default.createElement(_reactNative.SafeAreaView,{__source:{fileName:_jsxFileName,lineNumber:85,columnNumber:13}},_react.default.createElement(_reactNativeActionsheet.default,{ref:function ref(o){return _this2.ActionSheet=o;},title:'Dữ liệu sẽ bị xoá vĩnh viễn!',options:['Xoá màu này','Huỷ bỏ'],cancelButtonIndex:1,destructiveButtonIndex:0,onPress:function onPress(index){if(index==0){_this2.getTaskByColorId(_this2.state.id).then(function(task){if(task.length==0){_this2.deleteColor(_this2.state.id);}else{_reactNative.Alert.alert('Thông báo','Màu này không thể xoá được',[{text:'OK',onPress:function onPress(){return console.log('OK Pressed');}}],{cancelable:false});}});}},__source:{fileName:_jsxFileName,lineNumber:86,columnNumber:17}}),_react.default.createElement(_reactNative.View,{style:styles.container,__source:{fileName:_jsxFileName,lineNumber:119,columnNumber:17}},_react.default.createElement(_reactNative.View,{style:([styles.backButton],{height:35,flexDirection:'row',justifyContent:'space-between',alignItems:'center',marginBottom:5}),__source:{fileName:_jsxFileName,lineNumber:120,columnNumber:21}},_react.default.createElement(_reactNative.TouchableOpacity,{onPress:function onPress(){return _this2.props.navigation.goBack();},style:{marginLeft:10},__source:{fileName:_jsxFileName,lineNumber:132,columnNumber:25}},_react.default.createElement(_reactNative.Image,{style:{height:25,width:40},source:require('../assets/back.png'),resizeMode:"contain",__source:{fileName:_jsxFileName,lineNumber:139,columnNumber:29}}))),_react.default.createElement(_reactNative.View,{style:{flex:1},__source:{fileName:_jsxFileName,lineNumber:151,columnNumber:21}}),_react.default.createElement(_reactNative.View,{style:styles.taskContainer,__source:{fileName:_jsxFileName,lineNumber:152,columnNumber:21}},_react.default.createElement(_reactNative.View,{style:{height:400,paddingBottom:25,backgroundColor:'#FFF'},__source:{fileName:_jsxFileName,lineNumber:153,columnNumber:25}},_react.default.createElement(_reactNative.Text,{style:styles.title,__source:{fileName:_jsxFileName,lineNumber:160,columnNumber:29}},"Ch\u1ECDn m\xE0u"),_react.default.createElement(_reactNativeColorPicker.TriangleColorPicker,{oldColor:"purple",color:this.state.color,onColorChange:this.onColorChange,onColorSelected:function onColorSelected(color){_this2.setState({selectedColor:color});},onOldColorSelected:function onOldColorSelected(color){_this2.setState({selectedColor:color});},style:{flex:1},__source:{fileName:_jsxFileName,lineNumber:161,columnNumber:29}})),_react.default.createElement(_reactNative.View,{__source:{fileName:_jsxFileName,lineNumber:180,columnNumber:25}},_react.default.createElement(_reactNative.Text,{style:styles.title,__source:{fileName:_jsxFileName,lineNumber:181,columnNumber:29}},"T\xEAn nh\xE3n"),_react.default.createElement(_reactNative.TextInput,{style:styles.newTask,onChangeText:function onChangeText(text){var prevSelectedTask=_objectSpread({},selected);prevSelectedTask.label=text;_this2.setState({selected:prevSelectedTask},function(){console.log(selected.label);});},value:selected.label,placeholder:"Nh\u1EADp t\xEAn nh\xE3n",autoFocus:true,__source:{fileName:_jsxFileName,lineNumber:182,columnNumber:29}}),_react.default.createElement(_reactNative.View,{style:styles.seperator,__source:{fileName:_jsxFileName,lineNumber:202,columnNumber:29}}),_react.default.createElement(_reactNative.View,{style:{flexDirection:'row',alignItems:'center',marginTop:10},__source:{fileName:_jsxFileName,lineNumber:203,columnNumber:29}},_react.default.createElement(_reactNative.Text,{style:styles.title,__source:{fileName:_jsxFileName,lineNumber:210,columnNumber:33}},"M\xE0u \u0111\xE3 ch\u1ECDn"),_react.default.createElement(_reactNative.View,{style:{height:30,width:30,backgroundColor:""+this.state.selectedColor,justifyContent:'center',borderRadius:15,marginLeft:20},__source:{fileName:_jsxFileName,lineNumber:211,columnNumber:33}})))),_react.default.createElement(_reactNative.View,{style:{flexDirection:'row',justifyContent:'center',alignItems:'center'},__source:{fileName:_jsxFileName,lineNumber:224,columnNumber:21}},_react.default.createElement(_reactNative.TouchableOpacity,{disabled:selected.label==='',style:[styles.updateButton,{backgroundColor:selected.label===''?'rgba(46, 102, 231,0.5)':'#2E66E7'}],onPress:function onPress(){_this2.updateColor(_this2.state.selected);},__source:{fileName:_jsxFileName,lineNumber:231,columnNumber:25}},_react.default.createElement(_reactNative.Text,{style:{fontSize:18,textAlign:'center',color:'#fff'},__source:{fileName:_jsxFileName,lineNumber:246,columnNumber:29}},"C\u1EADp nh\u1EADt")),_react.default.createElement(_reactNative.TouchableOpacity,{style:styles.deleteButton,onPress:function _callee(){return _regenerator.default.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this2.ActionSheet.show();case 1:case"end":return _context.stop();}}},null,null,null,Promise);},__source:{fileName:_jsxFileName,lineNumber:256,columnNumber:25}},_react.default.createElement(_reactNative.Text,{style:{fontSize:18,textAlign:'center',color:'#fff'},__source:{fileName:_jsxFileName,lineNumber:262,columnNumber:29}},"Xo\xE1")))));}}]);return App;}(_react.Component);exports.default=App;var styles=_reactNative.StyleSheet.create({container:{},taskContainer:{width:327,alignSelf:'center',borderRadius:20,shadowColor:'#2E66E7',backgroundColor:'#ffffff',shadowOffset:{width:3,height:3},shadowRadius:20,shadowOpacity:0.2,elevation:5,padding:22},seperator:{height:0.5,width:'100%',backgroundColor:'#979797',alignSelf:'center',marginVertical:5},newTask:{fontSize:20,height:25},title:{color:'#9CAAC4',fontSize:16,fontWeight:'600',marginVertical:10},createTaskButton:{width:327,height:48,alignSelf:'center',marginTop:20,borderRadius:5,justifyContent:'center'},deleteButton:{backgroundColor:'#ff6347',width:150,height:38,alignSelf:'center',marginTop:20,borderRadius:5,justifyContent:'center'},updateButton:{backgroundColor:'#2E66E7',width:150,height:38,alignSelf:'center',marginTop:20,borderRadius:5,justifyContent:'center',marginRight:20}});