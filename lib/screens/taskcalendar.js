var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _moment=_interopRequireDefault(require("moment"));var _taskitem=_interopRequireDefault(require("../components/taskitem.js"));var _headercomponent=_interopRequireDefault(require("../components/headercomponent.js"));var _reactNativeModalDatetimePicker=_interopRequireDefault(require("react-native-modal-datetime-picker"));var _firebase=_interopRequireDefault(require("../database/firebase"));var _reactNativeActionsheet=_interopRequireDefault(require("react-native-actionsheet"));var _reactNativeCalendarStrip=_interopRequireDefault(require("react-native-calendar-strip"));var _reactNativeTimelineFlatlist=_interopRequireDefault(require("react-native-timeline-flatlist"));var _AntDesign=_interopRequireDefault(require("react-native-vector-icons/AntDesign"));var _rowtaskitem=_interopRequireDefault(require("../components/rowtaskitem"));var _jsxFileName="/Users/tuyento/ReactNative/KhoaLuan/todoapp/src/screens/taskcalendar.js";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return(0,_possibleConstructorReturn2.default)(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}var _Dimensions$get=_reactNative.Dimensions.get('window'),vw=_Dimensions$get.width;function nextDate(num){var today=(0,_moment.default)();var nextday=(0,_moment.default)(today).add(num,'days');var stringday=(0,_moment.default)(nextday).format('YYYY')+'/'+(0,_moment.default)(nextday).format('MM')+'/'+(0,_moment.default)(nextday).format('DD');return stringday;}function convertDateString(date){return(0,_moment.default)(date.toDate()).format('HH:mm');}var TaskCalendar=function(_Component){(0,_inherits2.default)(TaskCalendar,_Component);var _super=_createSuper(TaskCalendar);function TaskCalendar(props){var _this;(0,_classCallCheck2.default)(this,TaskCalendar);_this=_super.call(this,props);_this.getTask=function(id,datebegin,dateend){_firebase.default.firestore().collection('tasks').where('userid','==',id+'').where('time','>=',new Date(datebegin)).where('time','<',new Date(dateend)).orderBy('time').onSnapshot(function(querySnapshot){var todo=[];querySnapshot.forEach(function(doc){var _doc$data=doc.data(),time=_doc$data.time,title=_doc$data.title,notes=_doc$data.notes,isCompleted=_doc$data.isCompleted,colorid=_doc$data.colorid;todo.push({key:doc.id,description:notes,title:title,isCompleted:isCompleted,time:convertDateString(time),data:doc.data(),colorid:colorid});});_this.setState({todoList:todo});});};_this.renderDetail=_this.renderDetail.bind((0,_assertThisInitialized2.default)(_this));_this.state={userid:_firebase.default.auth().currentUser.uid,datesWhitelist:[{start:(0,_moment.default)(),end:(0,_moment.default)().add(365,'days')}],todoList:[],markedDate:[],currentDate:(0,_moment.default)().format('YYYY')+"-"+(0,_moment.default)().format('MM')+"-"+(0,_moment.default)().format('DD'),isModalVisible:false,selectedTask:null,isDateTimePickerVisible:false,keyTaskCurrent:''};return _this;}(0,_createClass2.default)(TaskCalendar,[{key:"renderDetail",value:function renderDetail(rowData,sectionID,rowID){var _this2=this;return _react.default.createElement(_rowtaskitem.default,{rowData:rowData,rowID:rowID,onPress:function onPress(){_this2.props.navigation.navigate('UpdateTask',{taskid:rowData.key,data:rowData.data});},__source:{fileName:_jsxFileName,lineNumber:105,columnNumber:13}});}},{key:"componentDidMount",value:function componentDidMount(){this.getTask(this.state.userid,nextDate(0),nextDate(1));}},{key:"render",value:function render(){var _this3=this;var _this$state=this.state,userid=_this$state.userid,datesWhitelist=_this$state.datesWhitelist,markedDate=_this$state.markedDate,todoList=_this$state.todoList,isModalVisible=_this$state.isModalVisible,selectedTask=_this$state.selectedTask,isDateTimePickerVisible=_this$state.isDateTimePickerVisible,currentDate=_this$state.currentDate,navigation=this.props.navigation;return _react.default.createElement(_reactNative.SafeAreaView,{style:{flex:1,backgroundColor:'#FFF'},__source:{fileName:_jsxFileName,lineNumber:137,columnNumber:13}},_react.default.createElement(_reactNative.View,{style:{flex:1},__source:{fileName:_jsxFileName,lineNumber:138,columnNumber:17}},_react.default.createElement(_reactNative.View,{style:([styles.backButton],{height:35,flexDirection:'row',justifyContent:'space-between',alignItems:'center'}),__source:{fileName:_jsxFileName,lineNumber:144,columnNumber:21}},_react.default.createElement(_reactNative.TouchableOpacity,{onPress:function onPress(){return _this3.props.navigation.goBack();},style:{marginLeft:10},__source:{fileName:_jsxFileName,lineNumber:155,columnNumber:25}},_react.default.createElement(_reactNative.Image,{style:{height:25,width:40},source:require('../assets/back.png'),resizeMode:"contain",__source:{fileName:_jsxFileName,lineNumber:162,columnNumber:29}})),_react.default.createElement(_reactNative.TouchableOpacity,{onPress:function onPress(){_this3.props.navigation.navigate('Addtask',{userid:_this3.state.userid});},__source:{fileName:_jsxFileName,lineNumber:185,columnNumber:25}},_react.default.createElement(_AntDesign.default,{name:'plus',size:30,color:'#0074D6',style:{width:32,marginRight:10},__source:{fileName:_jsxFileName,lineNumber:192,columnNumber:29}}))),_react.default.createElement(_reactNativeCalendarStrip.default,{ref:function ref(_ref){_this3.calenderRef=_ref;},calendarAnimation:{type:'sequence',duration:30},daySelectionAnimation:{type:'background',duration:200,highlightColor:'#ffffff'},style:{height:120,paddingBottom:20},calendarHeaderStyle:{color:'#000000'},dateNumberStyle:{color:'#000000',paddingTop:10},dateNameStyle:{color:'#BBBBBB'},highlightDateNumberStyle:{color:'#fff',backgroundColor:'#2E66E7',marginTop:10,height:35,width:35,textAlign:'center',borderRadius:17.5,overflow:'hidden',paddingTop:6,fontWeight:'400',justifyContent:'center',alignItems:'center'},highlightDateNameStyle:{color:'#2E66E7'},disabledDateNameStyle:{color:'grey'},disabledDateNumberStyle:{color:'grey',paddingTop:10},iconLeft:require('../assets/left-arrow.png'),iconRight:require('../assets/right-arrow.png'),iconContainer:{flex:0.1},markedDates:markedDate,selectedDate:(0,_moment.default)(),onDateSelected:function onDateSelected(date){var selectedDate=(0,_moment.default)(date).format('YYYY')+"/"+(0,_moment.default)(date).format('MM')+"/"+(0,_moment.default)(date).format('DD');var nextday=(0,_moment.default)(date).add(1,'days');var stringday=(0,_moment.default)(nextday).format('YYYY')+'/'+(0,_moment.default)(nextday).format('MM')+'/'+(0,_moment.default)(nextday).format('DD');_this3.getTask(_this3.state.userid,selectedDate,stringday);},__source:{fileName:_jsxFileName,lineNumber:200,columnNumber:21}}),_react.default.createElement(_reactNative.View,{style:{width:'100%',height:_reactNative.Dimensions.get('window').height-170},__source:{fileName:_jsxFileName,lineNumber:298,columnNumber:21}},_react.default.createElement(_reactNative.ScrollView,{contentContainerStyle:{paddingBottom:20},__source:{fileName:_jsxFileName,lineNumber:304,columnNumber:25}},_react.default.createElement(_reactNative.View,{style:{marginLeft:40,marginRight:40},__source:{fileName:_jsxFileName,lineNumber:309,columnNumber:29}},_react.default.createElement(_reactNativeTimelineFlatlist.default,{data:this.state.todoList,circleSize:20,circleColor:"#424F61",lineColor:"#424F61",timeContainerStyle:{minWidth:52,marginTop:-5},timeStyle:{textAlign:'center',backgroundColor:'#0074DE',color:'white',padding:5,borderRadius:13},descriptionStyle:{color:'gray'},options:{style:{paddingTop:5}},innerCircle:'dot',renderDetail:this.renderDetail,__source:{fileName:_jsxFileName,lineNumber:315,columnNumber:33}}))))));}}]);return TaskCalendar;}(_react.Component);exports.default=TaskCalendar;var styles=_reactNative.StyleSheet.create({taskListContent:{height:100,width:327,alignSelf:'center',borderRadius:10,shadowColor:'#2E66E7',backgroundColor:'#ffffff',marginTop:10,marginBottom:10,shadowOffset:{width:3,height:3},shadowRadius:5,shadowOpacity:0.2,elevation:3,flexDirection:'row',justifyContent:'space-between',alignItems:'center'},backButton:{flexDirection:'row',marginTop:30,width:'100%',alignItems:'center'},newTask:{alignSelf:'center',fontSize:20,width:120,height:25,textAlign:'center'},cardMain:{position:'absolute',top:100,width:327,borderRadius:20,backgroundColor:'#ffffff',alignSelf:'center'},container:{flex:1,backgroundColor:'rgba(0,0,0,0.5)'},title:{fontSize:16,fontWeight:'bold'},descriptionContainer:{flexDirection:'row',paddingRight:50},image:{width:50,height:50,borderRadius:25},textDescription:{marginLeft:10,color:'gray'},buttonSlide:{color:'white',padding:5,alignItems:'center'}});